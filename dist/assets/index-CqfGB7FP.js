(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const _ of o.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&r(_)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var B,d,At,A,pt,Mt,$t,Ut,at,ot,it,Lt,q={},Ht=[],te=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,j=Array.isArray;function R(e,t){for(var n in t)e[n]=t[n];return e}function ht(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function M(e,t,n){var r,i,o,_={};for(o in t)o=="key"?r=t[o]:o=="ref"?i=t[o]:_[o]=t[o];if(arguments.length>2&&(_.children=arguments.length>3?B.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)_[o]===void 0&&(_[o]=e.defaultProps[o]);return O(e,_,r,i,null)}function O(e,t,n,r,i){var o={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++At,__i:-1,__u:0};return i==null&&d.vnode!=null&&d.vnode(o),o}function ee(){return{current:null}}function V(e){return e.children}function N(e,t){this.props=e,this.context=t}function H(e,t){if(t==null)return e.__?H(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?H(e):null}function zt(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return zt(e)}}function st(e){(!e.__d&&(e.__d=!0)&&A.push(e)&&!Z.__r++||pt!=d.debounceRendering)&&((pt=d.debounceRendering)||Mt)(Z)}function Z(){for(var e,t,n,r,i,o,_,l=1;A.length;)A.length>l&&A.sort($t),e=A.shift(),l=A.length,e.__d&&(n=void 0,r=void 0,i=(r=(t=e).__v).__e,o=[],_=[],t.__P&&((n=R({},r)).__v=r.__v+1,d.vnode&&d.vnode(n),ut(t.__P,n,r,t.__n,t.__P.namespaceURI,32&r.__u?[i]:null,o,i??H(r),!!(32&r.__u),_),n.__v=r.__v,n.__.__k[n.__i]=n,qt(o,n,_),r.__e=r.__=null,n.__e!=i&&zt(n)));Z.__r=0}function Ft(e,t,n,r,i,o,_,l,a,c,f){var s,u,h,v,k,x,m,p=r&&r.__k||Ht,P=t.length;for(a=ne(n,t,p,a,P),s=0;s<P;s++)(h=n.__k[s])!=null&&(u=h.__i==-1?q:p[h.__i]||q,h.__i=s,x=ut(e,h,u,i,o,_,l,a,c,f),v=h.__e,h.ref&&u.ref!=h.ref&&(u.ref&&ft(u.ref,null,h),f.push(h.ref,h.__c||v,h)),k==null&&v!=null&&(k=v),(m=!!(4&h.__u))||u.__k===h.__k?a=Ot(h,a,e,m):typeof h.type=="function"&&x!==void 0?a=x:v&&(a=v.nextSibling),h.__u&=-7);return n.__e=k,a}function ne(e,t,n,r,i){var o,_,l,a,c,f=n.length,s=f,u=0;for(e.__k=new Array(i),o=0;o<i;o++)(_=t[o])!=null&&typeof _!="boolean"&&typeof _!="function"?(typeof _=="string"||typeof _=="number"||typeof _=="bigint"||_.constructor==String?_=e.__k[o]=O(null,_,null,null,null):j(_)?_=e.__k[o]=O(V,{children:_},null,null,null):_.constructor===void 0&&_.__b>0?_=e.__k[o]=O(_.type,_.props,_.key,_.ref?_.ref:null,_.__v):e.__k[o]=_,a=o+u,_.__=e,_.__b=e.__b+1,l=null,(c=_.__i=re(_,n,a,s))!=-1&&(s--,(l=n[c])&&(l.__u|=2)),l==null||l.__v==null?(c==-1&&(i>f?u--:i<f&&u++),typeof _.type!="function"&&(_.__u|=4)):c!=a&&(c==a-1?u--:c==a+1?u++:(c>a?u--:u++,_.__u|=4))):e.__k[o]=null;if(s)for(o=0;o<f;o++)(l=n[o])!=null&&(2&l.__u)==0&&(l.__e==r&&(r=H(l)),jt(l,l));return r}function Ot(e,t,n,r){var i,o;if(typeof e.type=="function"){for(i=e.__k,o=0;i&&o<i.length;o++)i[o]&&(i[o].__=e,t=Ot(i[o],t,n,r));return t}e.__e!=t&&(r&&(t&&e.type&&!t.parentNode&&(t=H(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function Nt(e,t){return t=t||[],e==null||typeof e=="boolean"||(j(e)?e.some(function(n){Nt(n,t)}):t.push(e)),t}function re(e,t,n,r){var i,o,_,l=e.key,a=e.type,c=t[n],f=c!=null&&(2&c.__u)==0;if(c===null&&l==null||f&&l==c.key&&a==c.type)return n;if(r>(f?1:0)){for(i=n-1,o=n+1;i>=0||o<t.length;)if((c=t[_=i>=0?i--:o++])!=null&&(2&c.__u)==0&&l==c.key&&a==c.type)return _}return-1}function mt(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||te.test(t)?n:n+"px"}function Y(e,t,n,r,i){var o,_;t:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||mt(e.style,t,"");if(n)for(t in n)r&&n[t]==r[t]||mt(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")o=t!=(t=t.replace(Ut,"$1")),_=t.toLowerCase(),t=_ in e||t=="onFocusOut"||t=="onFocusIn"?_.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?r?n.u=r.u:(n.u=at,e.addEventListener(t,o?it:ot,o)):e.removeEventListener(t,o?it:ot,o);else{if(i=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break t}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function vt(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=at++;else if(t.t<n.u)return;return n(d.event?d.event(t):t)}}}function ut(e,t,n,r,i,o,_,l,a,c){var f,s,u,h,v,k,x,m,p,P,S,$,C,J,U,w,I,D=t.type;if(t.constructor!==void 0)return null;128&n.__u&&(a=!!(32&n.__u),o=[l=t.__e=n.__e]),(f=d.__b)&&f(t);t:if(typeof D=="function")try{if(m=t.props,p="prototype"in D&&D.prototype.render,P=(f=D.contextType)&&r[f.__c],S=f?P?P.props.value:f.__:r,n.__c?x=(s=t.__c=n.__c).__=s.__E:(p?t.__c=s=new D(m,S):(t.__c=s=new N(m,S),s.constructor=D,s.render=ie),P&&P.sub(s),s.state||(s.state={}),s.__n=r,u=s.__d=!0,s.__h=[],s._sb=[]),p&&s.__s==null&&(s.__s=s.state),p&&D.getDerivedStateFromProps!=null&&(s.__s==s.state&&(s.__s=R({},s.__s)),R(s.__s,D.getDerivedStateFromProps(m,s.__s))),h=s.props,v=s.state,s.__v=t,u)p&&D.getDerivedStateFromProps==null&&s.componentWillMount!=null&&s.componentWillMount(),p&&s.componentDidMount!=null&&s.__h.push(s.componentDidMount);else{if(p&&D.getDerivedStateFromProps==null&&m!==h&&s.componentWillReceiveProps!=null&&s.componentWillReceiveProps(m,S),t.__v==n.__v||!s.__e&&s.shouldComponentUpdate!=null&&s.shouldComponentUpdate(m,s.__s,S)===!1){for(t.__v!=n.__v&&(s.props=m,s.state=s.__s,s.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(L){L&&(L.__=t)}),$=0;$<s._sb.length;$++)s.__h.push(s._sb[$]);s._sb=[],s.__h.length&&_.push(s);break t}s.componentWillUpdate!=null&&s.componentWillUpdate(m,s.__s,S),p&&s.componentDidUpdate!=null&&s.__h.push(function(){s.componentDidUpdate(h,v,k)})}if(s.context=S,s.props=m,s.__P=e,s.__e=!1,C=d.__r,J=0,p){for(s.state=s.__s,s.__d=!1,C&&C(t),f=s.render(s.props,s.state,s.context),U=0;U<s._sb.length;U++)s.__h.push(s._sb[U]);s._sb=[]}else do s.__d=!1,C&&C(t),f=s.render(s.props,s.state,s.context),s.state=s.__s;while(s.__d&&++J<25);s.state=s.__s,s.getChildContext!=null&&(r=R(R({},r),s.getChildContext())),p&&!u&&s.getSnapshotBeforeUpdate!=null&&(k=s.getSnapshotBeforeUpdate(h,v)),w=f,f!=null&&f.type===V&&f.key==null&&(w=Bt(f.props.children)),l=Ft(e,j(w)?w:[w],t,n,r,i,o,_,l,a,c),s.base=t.__e,t.__u&=-161,s.__h.length&&_.push(s),x&&(s.__E=s.__=null)}catch(L){if(t.__v=null,a||o!=null)if(L.then){for(t.__u|=a?160:128;l&&l.nodeType==8&&l.nextSibling;)l=l.nextSibling;o[o.indexOf(l)]=null,t.__e=l}else{for(I=o.length;I--;)ht(o[I]);_t(t)}else t.__e=n.__e,t.__k=n.__k,L.then||_t(t);d.__e(L,t,n)}else o==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):l=t.__e=oe(n.__e,t,n,r,i,o,_,a,c);return(f=d.diffed)&&f(t),128&t.__u?void 0:l}function _t(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(_t)}function qt(e,t,n){for(var r=0;r<n.length;r++)ft(n[r],n[++r],n[++r]);d.__c&&d.__c(t,e),e.some(function(i){try{e=i.__h,i.__h=[],e.some(function(o){o.call(i)})}catch(o){d.__e(o,i.__v)}})}function Bt(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:j(e)?e.map(Bt):R({},e)}function oe(e,t,n,r,i,o,_,l,a){var c,f,s,u,h,v,k,x=n.props||q,m=t.props,p=t.type;if(p=="svg"?i="http://www.w3.org/2000/svg":p=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),o!=null){for(c=0;c<o.length;c++)if((h=o[c])&&"setAttribute"in h==!!p&&(p?h.localName==p:h.nodeType==3)){e=h,o[c]=null;break}}if(e==null){if(p==null)return document.createTextNode(m);e=document.createElementNS(i,p,m.is&&m),l&&(d.__m&&d.__m(t,o),l=!1),o=null}if(p==null)x===m||l&&e.data==m||(e.data=m);else{if(o=o&&B.call(e.childNodes),!l&&o!=null)for(x={},c=0;c<e.attributes.length;c++)x[(h=e.attributes[c]).name]=h.value;for(c in x)if(h=x[c],c!="children"){if(c=="dangerouslySetInnerHTML")s=h;else if(!(c in m)){if(c=="value"&&"defaultValue"in m||c=="checked"&&"defaultChecked"in m)continue;Y(e,c,null,h,i)}}for(c in m)h=m[c],c=="children"?u=h:c=="dangerouslySetInnerHTML"?f=h:c=="value"?v=h:c=="checked"?k=h:l&&typeof h!="function"||x[c]===h||Y(e,c,h,x[c],i);if(f)l||s&&(f.__html==s.__html||f.__html==e.innerHTML)||(e.innerHTML=f.__html),t.__k=[];else if(s&&(e.innerHTML=""),Ft(t.type=="template"?e.content:e,j(u)?u:[u],t,n,r,p=="foreignObject"?"http://www.w3.org/1999/xhtml":i,o,_,o?o[0]:n.__k&&H(n,0),l,a),o!=null)for(c=o.length;c--;)ht(o[c]);l||(c="value",p=="progress"&&v==null?e.removeAttribute("value"):v!=null&&(v!==e[c]||p=="progress"&&!v||p=="option"&&v!=x[c])&&Y(e,c,v,x[c],i),c="checked",k!=null&&k!=e[c]&&Y(e,c,k,x[c],i))}return e}function ft(e,t,n){try{if(typeof e=="function"){var r=typeof e.__u=="function";r&&e.__u(),r&&t==null||(e.__u=e(t))}else e.current=t}catch(i){d.__e(i,n)}}function jt(e,t,n){var r,i;if(d.unmount&&d.unmount(e),(r=e.ref)&&(r.current&&r.current!=e.__e||ft(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){d.__e(o,t)}r.base=r.__P=null}if(r=e.__k)for(i=0;i<r.length;i++)r[i]&&jt(r[i],t,n||typeof e.type!="function");n||ht(e.__e),e.__c=e.__=e.__e=void 0}function ie(e,t,n){return this.constructor(e,n)}function se(e,t,n){var r,i,o,_;t==document&&(t=document.documentElement),d.__&&d.__(e,t),i=(r=!1)?null:t.__k,o=[],_=[],ut(t,e=t.__k=M(V,null,[e]),i||q,q,t.namespaceURI,i?null:t.firstChild?B.call(t.childNodes):null,o,i?i.__e:t.firstChild,r,_),qt(o,e,_)}function gt(e,t,n){var r,i,o,_,l=R({},e.props);for(o in e.type&&e.type.defaultProps&&(_=e.type.defaultProps),t)o=="key"?r=t[o]:o=="ref"?i=t[o]:l[o]=t[o]===void 0&&_!=null?_[o]:t[o];return arguments.length>2&&(l.children=arguments.length>3?B.call(arguments,2):n),O(e.type,l,r||e.key,i||e.ref,null)}function Kt(e){function t(n){var r,i;return this.getChildContext||(r=new Set,(i={})[t.__c]=this,this.getChildContext=function(){return i},this.componentWillUnmount=function(){r=null},this.shouldComponentUpdate=function(o){this.props.value!=o.value&&r.forEach(function(_){_.__e=!0,st(_)})},this.sub=function(o){r.add(o);var _=o.componentWillUnmount;o.componentWillUnmount=function(){r&&r.delete(o),_&&_.call(o)}}),n.children}return t.__c="__cC"+Lt++,t.__=e,t.Provider=t.__l=(t.Consumer=function(n,r){return n.children(r)}).contextType=t,t}B=Ht.slice,d={__e:function(e,t,n,r){for(var i,o,_;t=t.__;)if((i=t.__c)&&!i.__)try{if((o=i.constructor)&&o.getDerivedStateFromError!=null&&(i.setState(o.getDerivedStateFromError(e)),_=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(e,r||{}),_=i.__d),_)return i.__E=i}catch(l){e=l}throw e}},At=0,N.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=R({},this.state),typeof e=="function"&&(e=e(R({},n),this.props)),e&&R(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),st(this))},N.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),st(this))},N.prototype.render=V,A=[],Mt=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,$t=function(e,t){return e.__v.__b-t.__v.__b},Z.__r=0,Ut=/(PointerCapture)$|Capture$/i,at=0,ot=vt(!1),it=vt(!0),Lt=0;var _e=0;function g(e,t,n,r,i,o){t||(t={});var _,l,a=t;if("ref"in a)for(l in a={},t)l=="ref"?_=t[l]:a[l]=t[l];var c={type:e,props:a,key:n,ref:_,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--_e,__i:-1,__u:0,__source:i,__self:o};if(typeof e=="function"&&(_=e.defaultProps))for(l in _)a[l]===void 0&&(a[l]=_[l]);return d.vnode&&d.vnode(c),c}var z,y,et,yt,lt=0,Jt=[],b=d,wt=b.__b,xt=b.__r,bt=b.diffed,kt=b.__c,Pt=b.unmount,St=b.__;function tt(e,t){b.__h&&b.__h(y,e,lt||t),lt=0;var n=y.__H||(y.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function Yt(e,t,n){var r=tt(z++,2);if(r.t=e,!r.__c&&(r.__=[ae(void 0,t),function(l){var a=r.__N?r.__N[0]:r.__[0],c=r.t(a,l);a!==c&&(r.__N=[c,r.__[1]],r.__c.setState({}))}],r.__c=y,!y.__f)){var i=function(l,a,c){if(!r.__c.__H)return!0;var f=r.__c.__H.__.filter(function(u){return!!u.__c});if(f.every(function(u){return!u.__N}))return!o||o.call(this,l,a,c);var s=r.__c.props!==l;return f.forEach(function(u){if(u.__N){var h=u.__[0];u.__=u.__N,u.__N=void 0,h!==u.__[0]&&(s=!0)}}),o&&o.call(this,l,a,c)||s};y.__f=!0;var o=y.shouldComponentUpdate,_=y.componentWillUpdate;y.componentWillUpdate=function(l,a,c){if(this.__e){var f=o;o=void 0,i(l,a,c),o=f}_&&_.call(this,l,a,c)},y.shouldComponentUpdate=i}return r.__N||r.__}function Xt(e,t){var n=tt(z++,4);!b.__s&&Qt(n.__H,t)&&(n.__=e,n.u=t,y.__h.push(n))}function E(e){return lt=5,dt(function(){return{current:e}},[])}function dt(e,t){var n=tt(z++,7);return Qt(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function Gt(e){var t=y.context[e.__c],n=tt(z++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(y)),t.props.value):e.__}function le(){for(var e;e=Jt.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Q),e.__H.__h.forEach(ct),e.__H.__h=[]}catch(t){e.__H.__h=[],b.__e(t,e.__v)}}b.__b=function(e){y=null,wt&&wt(e)},b.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),St&&St(e,t)},b.__r=function(e){xt&&xt(e),z=0;var t=(y=e.__c).__H;t&&(et===y?(t.__h=[],y.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(Q),t.__h.forEach(ct),t.__h=[],z=0)),et=y},b.diffed=function(e){bt&&bt(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Jt.push(t)!==1&&yt===b.requestAnimationFrame||((yt=b.requestAnimationFrame)||ce)(le)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),et=y=null},b.__c=function(e,t){t.some(function(n){try{n.__h.forEach(Q),n.__h=n.__h.filter(function(r){return!r.__||ct(r)})}catch(r){t.some(function(i){i.__h&&(i.__h=[])}),t=[],b.__e(r,n.__v)}}),kt&&kt(e,t)},b.unmount=function(e){Pt&&Pt(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{Q(r)}catch(i){t=i}}),n.__H=void 0,t&&b.__e(t,n.__v))};var Dt=typeof requestAnimationFrame=="function";function ce(e){var t,n=function(){clearTimeout(r),Dt&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,35);Dt&&(t=requestAnimationFrame(n))}function Q(e){var t=y,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),y=t}function ct(e){var t=y;e.__c=e.__(),y=t}function Qt(e,t){return!e||e.length!==t.length||t.some(function(n,r){return n!==e[r]})}function ae(e,t){return typeof t=="function"?t(e):t}let W,F;const he=(e,t)=>{if(W=void 0,t&&t.type==="click"){if(t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||t.button!==0)return e;const n=t.composedPath().find(i=>i.nodeName=="A"&&i.href),r=n&&n.getAttribute("href");if(!n||n.origin!=location.origin||/^#/.test(r)||!/^(_?self)?$/i.test(n.target)||F&&(typeof F=="string"?!r.startsWith(F):!F.test(r)))return e;W=!0,t.preventDefault(),t=n.href.replace(location.origin,"")}else typeof t=="string"?W=!0:t&&t.url?(W=!t.replace,t=t.url):t=location.pathname+location.search;return W===!0?history.pushState(null,"",t):W===!1&&history.replaceState(null,"",t),t},ue=(e,t,n={})=>{e=e.split("/").filter(Boolean),t=(t||"").split("/").filter(Boolean),n.params||(n.params={});for(let r=0,i,o;r<Math.max(e.length,t.length);r++){let[,_,l,a]=(t[r]||"").match(/^(:?)(.*?)([+*?]?)$/);if(i=e[r],!(!_&&l==i)){if(!_&&i&&a=="*"){n.rest="/"+e.slice(r).map(decodeURIComponent).join("/");break}if(!_||!i&&a!="?"&&a!="*")return;if(o=a=="+"||a=="*",o?i=e.slice(r).map(decodeURIComponent).join("/")||void 0:i&&(i=decodeURIComponent(i)),n.params[l]=i,l in n||(n[l]=i),o)break}}return n};function K(e){const[t,n]=Yt(he,e.url||location.pathname+location.search);e.scope&&(F=e.scope);const r=W===!0,i=dt(()=>{const o=new URL(t,location.origin),_=o.pathname.replace(/\/+$/g,"")||"/";return{url:t,path:_,query:Object.fromEntries(o.searchParams),route:(l,a)=>n({url:l,replace:a}),wasPush:r}},[t]);return Xt(()=>(addEventListener("click",n),addEventListener("popstate",n),()=>{removeEventListener("click",n),removeEventListener("popstate",n)}),[]),M(K.ctx.Provider,{value:i},e.children)}const fe=Promise.resolve();function Zt(e){const[t,n]=Yt(w=>w+1,0),{url:r,query:i,wasPush:o,path:_}=Vt();if(!r)throw new Error("preact-iso's <Router> must be used within a <LocationProvider>, see: https://github.com/preactjs/preact-iso#locationprovider");const{rest:l=_,params:a={}}=Gt(Rt),c=E(!1),f=E(_),s=E(0),u=E(),h=E(),v=E(),k=E(!1),x=E();x.current=!1;let m,p,P;Nt(e.children).some(w=>{if(ue(l,w.props.path,P={...w.props,path:l,query:i,params:a,rest:""}))return m=gt(w,P);w.props.default&&(p=gt(w,P))});let S=m||p;const $=u.current&&u.current.__u&X&&u.current.__u&G,C=u.current&&u.current.__h,J=dt(()=>{h.current=u.current,u.current=M(Rt.Provider,{value:P},S);const w=h.current&&h.current.props.children;return!w||!S||S.type!==w.type||S.props.component!==w.props.component?(this.__v&&this.__v.__k&&this.__v.__k.reverse(),s.current++,!0):!1},[r,JSON.stringify(P)]);$?(u.current.__u|=X,u.current.__u|=G):C&&(u.current.__h=!0);const U=h.current;return h.current=null,this.__c=(w,I)=>{x.current=!0,h.current=U,e.onLoadStart&&e.onLoadStart(r),c.current=!0;let D=s.current;w.then(()=>{D===s.current&&(h.current=null,u.current&&(I.__h&&(u.current.__h=I.__h),I.__u&G&&(u.current.__u|=G),I.__u&X&&(u.current.__u|=X)),fe.then(n))})},Xt(()=>{const w=this.__v&&this.__v.__e;if(x.current){!k.current&&!v.current&&(v.current=w);return}!k.current&&v.current&&(v.current!==w&&v.current.remove(),v.current=null),k.current=!0,f.current!==_&&(o&&scrollTo(0,0),e.onRouteChange&&e.onRouteChange(r),f.current=_),e.onLoadEnd&&c.current&&e.onLoadEnd(r),c.current=!1},[_,o,t]),J?[M(nt,{r:u}),M(nt,{r:h})]:M(nt,{r:u})}const X=32,G=128,nt=({r:e})=>e.current;Zt.Provider=K;K.ctx=Kt({});const Rt=Kt({}),rt=e=>M(e.component,e),Vt=()=>Gt(K.ctx),It=d.__b;d.__b=e=>{e.type&&e.type._forwarded&&e.ref&&(e.props.ref=e.ref,e.ref=null),It&&It(e)};const Et=d.__e;d.__e=(e,t,n)=>{if(e&&e.then){let r=t;for(;r=r.__;)if(r.__c&&r.__c.__c)return t.__e==null&&(t.__c.__z=[n.__e],t.__e=n.__e,t.__k=n.__k),t.__k||(t.__k=[]),r.__c.__c(e,t)}Et&&Et(e,t,n)};function de(){const{url:e}=Vt(),t=new URL(window.location.href);return g("header",{children:g("nav",{children:[g("a",{href:"/",class:e=="/"&&"active",children:"OpenTier"}),g("span",{children:t.pathname})]})})}function Tt(){return g("div",{class:"home",children:g("h1",{children:"OpenTier"})})}class T{constructor(t=0,n=0){this.set(t,n)}sub(t){return this.x-=t.x,this.y-=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}set(t=0,n=0){return this.x=t,this.y=n,this}copy(t){return this.set(t.x,t.y),this}scale(t){return this.x*=t,this.y*=t,this}mul(t){return this.x*=t.x,this.y*=t.y,this}div(t){return this.x/=t.x,this.y/=t.y,this}mag(){return Math.abs(Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)))}lerp(t,n=1){return this.x=Ct(this.x,t.x,n),this.y=Ct(this.y,t.y,n),this}dist(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}}const Ct=(e,t,n)=>e*(1-n)+t*n,Wt=new Map;class pe{constructor(t){this.waiting=new Set,new Promise(t).then(n=>{this.resolve(n,void 0)}).catch(n=>{this.resolve(void 0,n)})}resolve(t,n){this.v=t,this.reason=n;for(const r of this.waiting)r(t,n);this.waiting.clear()}then(t){this.v||this.reason?t(this.v,this.reason):this.waiting.add(t)}}function me(e){let t=Wt.get(e);return t||(t=new pe((n,r)=>{console.log("loading",e);const i=new Image;i.src=e,i.addEventListener("load",o=>{n(i)}),i.addEventListener("error",o=>{r(o.error)})}),Wt.set(e,t)),console.log("get",e),t}class ve{constructor(){this.targetPosition=new T,this.position=new T,this.data={},this.width=1,this.height=1}setData(t){if(this.data=t,!!this.data)return this.targetPosition.set(this.data.column,this.data.row),this.data.imageUrl&&me(this.data.imageUrl).then((n,r)=>{this.image=n}),this}render(t,n=!1){this.position.lerp(this.targetPosition,.1),this.image?t.drawImage(this.image,0,0,1,1):(t.fillStyle=this.data.bg,t.fillRect(0,0,this.width,this.height),t.fillStyle=this.data.fg,t.textAlign="center",t.textBaseline="middle",t.fillText(this.data.text,.5,.5,1));const r=.02;return n&&(t.strokeStyle=this.data.fg,t.strokeRect(0-r,0-r,1+r*2,1+r*2)),this.position.dist(this.targetPosition)>.025}}class ge{constructor(t,n="untitled",r=""){this.items=new Set,this.id=t,this.name=n,this.ownerid=r,this.owner={id:r,username:"OpenTier"}}}function ye(e){const r=new DOMParser().parseFromString(e,"text/html").querySelector("img");return r?r.src:""}class we extends N{constructor(t){super(t),this.needsRedraw=!0,this.canvasRef=ee(),this.zoomAmount=1/6,this.zoomWheelRate=1/1e3,this.zoomMin=.01,this.zoomMax=1,this.translation=new T,this.ratio=1,this.pointerDom=new T,this.pointerRender=new T,this.pointerWorld=new T,this.pointerWorldPrev=new T,this.pointerWorldDelta=new T,this.pointerIsDown=!1,console.log("Tier Id",this.props.tierid);const n=new ge(this.props.tierid,"Demo Tier","abcde");this.state={list:n};const r=this.restore();console.log("restore count",r),r<1&&(this.item({bg:"red",fg:"white",text:"S",column:0,row:0}),this.item({bg:"orange",fg:"white",text:"A",column:0,row:1}),this.item({bg:"yellow",fg:"white",text:"B",column:0,row:2}),this.item({bg:"green",fg:"white",text:"C",column:0,row:3}),this.item({bg:"blue",fg:"white",text:"D",column:0,row:4}),this.item({bg:"purple",fg:"white",text:"F",column:0,row:5}),this.save())}item(t){const n=t.column,r=t.row;t.column=Math.floor(t.column),t.row=Math.floor(t.row);const i=new ve().setData(t);i.position.set(n,r),this.state.list.items.add(i)}renderCanvas(){this.needsRedraw=!1;const t=this.ctx,n=this.canvasRef.current;if(n||console.warn("no canvas?"),n==null)return;this.ratio=n.height/n.width,t.save(),t.lineWidth=1/n.height*2,t.scale(n.height,n.height),t.clearRect(0,0,1/this.ratio,1),t.fillStyle="white";const r=(this.zoomAmount*100).toFixed(0);let i=1;t.save(),t.scale(this.zoomAmount,this.zoomAmount),t.translate(this.translation.x,this.translation.y),i=.5,t.font=`${i}px courier`;for(const o of this.state.list.items)t.save(),t.translate(o.position.x,o.position.y),o.render(t,this.selectedItem==o)&&(this.needsRedraw=!0),t.restore();t.strokeRect(this.pointerWorld.x,this.pointerWorld.y,.05,.05),t.restore(),i=.03,t.font=`${i}px courier`,t.fillText(`Zoom: ${r}%`,.025,.05),this.needsRedraw&&(t.strokeStyle="red",t.strokeRect(0,0,.01,.01)),t.restore()}fixCanvasRes(){const t=this.canvasRef.current,n=t.parentElement;t.style.display="none";const r=n.getBoundingClientRect(),i=r.width,o=r.height;t.width=Math.floor(i),t.height=Math.floor(o),t.style.width=t.width+"px",t.style.height=t.height+"px",t.style.display="unset",this.needsRedraw=!0}componentDidMount(){const t=this.canvasRef.current;this.ctx=t.getContext("2d"),window.onresize=()=>{this.fixCanvasRes()},this.onAnimationFrame=n=>{window.requestAnimationFrame(this.onAnimationFrame),this.needsRedraw&&this.renderCanvas()},window.requestAnimationFrame(this.onAnimationFrame),setInterval(()=>{this.needsRedraw=!0},1e3),setTimeout(()=>{this.fixCanvasRes()},500)}onPointerDown(){console.log(this.pointerWorld)}findItemUnderPointer(){for(const t of this.state.list.items)if(this.pointerWorld.y>t.targetPosition.y&&this.pointerWorld.y<t.targetPosition.y+1&&this.pointerWorld.x>t.targetPosition.x&&this.pointerWorld.x<t.targetPosition.x+1)return t;return null}onPointerUp(){this.selectedItemMove=!1;const t=this.findItemUnderPointer();if(t==null){this.selectedItem=null;return}this.selectedItem?(this.save(),this.selectedItem=null):this.selectedItem=t}domToRender(t){const n=this.canvasRef.current;t.x/=n.height,t.y/=n.height}renderToWorld(t){t.scale(1/this.zoomAmount),t.sub(this.translation)}domToWorld(t){this.domToRender(t),this.renderToWorld(t)}pointerEventUpdatePosition(t){this.pointerWorldPrev.copy(this.pointerWorld),this.pointerDom.set(t.offsetX,t.offsetY),this.pointerRender.copy(this.pointerDom),this.domToRender(this.pointerRender),this.pointerWorld.copy(this.pointerRender),this.renderToWorld(this.pointerWorld),this.pointerWorldDelta.set(t.movementX,t.movementY),this.domToRender(this.pointerWorldDelta),this.pointerWorldDelta.scale(1/this.zoomAmount)}renderDrawerItem(t){return g("img",{class:"item",src:t.imageUrl,onDragStart:n=>{n.dataTransfer.setData("text/plain",t.id)}})}renderDrawerItems(){const t=[];for(const n of this.state.list.items)t.push(this.renderDrawerItem(n.data));return t}renderItemAction(t,n,r){return g("div",{class:"item-action",onClick:()=>{r(this.selectedItem)},children:[g("div",{class:"item-action-icon",style:{backgroundImage:`url("${n}")`}}),t&&g("span",{children:t})]})}getKeyPrefix(){return`${this.state.list.id}:`}saveToLocalStorage(){const t=this.state.list.items,n=this.getKeyPrefix();for(let i=0;i<localStorage.length;i++){const o=localStorage.key(i);o.startsWith(n)&&localStorage.removeItem(o)}let r=0;for(const i of t){const o=`${n}${r}`;console.log("saving key",o);const _=JSON.stringify(i.data);localStorage.setItem(o,_),r++}}save(){this.saveToLocalStorage()}restoreFromLocalStorage(){const t=this.getKeyPrefix();let n=0;for(let r=0;r<localStorage.length;r++){const i=localStorage.key(r);if(!i.startsWith(t))continue;const o=localStorage.getItem(i),_=JSON.parse(o);n++,this.item(_)}return n}restore(){return this.restoreFromLocalStorage()}render(){return g("div",{class:"tier",children:g("div",{class:"col",style:{flex:1},children:[g("div",{class:"row",style:{flex:1},children:g("div",{class:"container",children:g("canvas",{ref:this.canvasRef,onWheel:t=>{this.zoomAmount-=t.deltaY*this.zoomWheelRate*this.zoomAmount,this.zoomAmount<this.zoomMin?this.zoomAmount=this.zoomMin:this.zoomAmount>this.zoomMax&&(this.zoomAmount=this.zoomMax),this.needsRedraw=!0},onPointerDown:t=>{this.pointerEventUpdatePosition(t),this.onPointerDown(),this.pointerIsDown=!0},onPointerUp:t=>{this.pointerEventUpdatePosition(t),this.onPointerUp(),this.pointerIsDown=!1},onPointerMove:t=>{this.pointerEventUpdatePosition(t),this.selectedItem&&this.selectedItemMove?(this.selectedItem.data.column=this.selectedItem.targetPosition.x=Math.floor(this.pointerWorld.x),this.selectedItem.data.row=this.selectedItem.targetPosition.y=Math.floor(this.pointerWorld.y)):this.pointerIsDown&&this.translation.add(this.pointerWorldDelta),this.needsRedraw=!0},onDragOver:t=>{t.preventDefault()},onDrop:t=>{t.preventDefault(),this.pointerEventUpdatePosition(t);const n=t.dataTransfer.getData("text/html");if(t.dataTransfer.getData("text/uri-list"),t.dataTransfer.getData("text/plain"),n){const r=ye(n);this.item({fg:"black",bg:"white",text:"x",column:this.pointerWorld.x,row:this.pointerWorld.y,imageUrl:r}),this.save()}}})})}),g("div",{class:"item-actions",children:[this.renderItemAction("info","/icon_info.svg",t=>{console.log("action info",t)}),this.renderItemAction("move","/icon_move.svg",t=>{this.selectedItem&&(this.selectedItemMove=!0)}),this.renderItemAction("delete","/icon_delete.svg",t=>{this.selectedItem&&(this.state.list.items.delete(this.selectedItem),this.save())})]})]})})}}window.addEventListener("wheel",e=>{e.preventDefault()},{passive:!1});window.addEventListener("touchstart",e=>{e.preventDefault()},{passive:!1});function xe(){return g(K,{children:[g(de,{}),g("main",{children:g(Zt,{children:[g(rt,{path:"/",component:Tt}),g(rt,{path:"/:tierid",component:we}),g(rt,{default:!0,component:Tt})]})})]})}se(g(xe,{}),document.getElementById("app"));
